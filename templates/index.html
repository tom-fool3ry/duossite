<html>

<head>
    <title>is duos up?</title>
    <link rel="icon" href="/static/images/icon.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@500&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/static/css/styles.css">
</head>

<body>
    <div class="root">
        <div class="message-container">
            <h1 class="answer"></h1>
            <h3 class="next"></h3>
        </div>
    </div>
</body>

<script type="text/javascript">
    const timeToStr = (time) => (time < 10 ? '0' : '') + time;
    const intervalSize = 5;
    const startTimeStr = "2023-10-24T22:00:00Z";
    let startTime = new Date(startTimeStr);
    setInterval(() => {
    
        let currentTime = new Date();
        let isOn = (Math.floor((Math.abs(startTime - currentTime) / 36e5)/intervalSize) % 2 ) == 0;
        const oppositeAns = {yes: 'no', no: 'yes'}
        const timeDifference = currentTime - startTime;

        const switchInterval = intervalSize * 60 * 60 * 1000;
        const nextSwitchTime = new Date(startTime.getTime() + Math.floor(timeDifference / switchInterval) * switchInterval + switchInterval);
        const timeLeft = nextSwitchTime - currentTime;
        const hoursLeft = timeToStr(Math.floor(timeLeft / (60 * 60 * 1000)));
        const minutesLeft = timeToStr(Math.floor((timeLeft % (60 * 60 * 1000)) / (60 * 1000)));
        const secondsLeft = timeToStr(Math.floor((timeLeft % (60 * 1000)) / 1000));
        
        const answer = isOn ? 'yes' : 'no';
        document.querySelector('.answer').textContent = answer;
        document.querySelector('title').textContent = answer;
        document.querySelector('.next').textContent = `duos is  ${isOn ? 'off' : 'on'} in ${hoursLeft}:${minutesLeft}:${secondsLeft}`
        let classes = document.querySelector('.root').classList;
        if (!classes.contains(answer)){
            classes.add(answer);
            classes.remove(oppositeAns[answer]);
        }
    }, 1000);
</script>
</html>
